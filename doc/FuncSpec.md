# 项目功能分析

---

## 桌面端

### 桌面服务端

- 总述：
	- 为桌面用户端提供服务；服务届时开启于端口`10475`，通过解析既有域名`zpss.info`提供服务。
	- 通过Java Socket实现客户端与服务端的通信；通过JDBC连接部署在同服务器的MySQL数据库，实现数据库的增删改查操作。
	- 根据客户端请求，执行对应SQL语句，从数据库中获取数据，生成对应DAO对象，通过特定消息串格式返回给客户端。
	- 将来自客户端特定消息串格式的消息解析为对应的DAO对象，执行对应SQL语句，将结果存入数据库实现数据持久化。
	- 因部署在云服务器端，采用无GUI界面设计，通过命令行输出日志信息。
- 树洞模块服务
	- 分区服务
		- 加入分区：客户端发送加入分区请求，服务端执行对应SQL语句，将用户-分区信息存入数据库，返回加入成功信息。
		- 退出分区：客户端发送退出分区请求，服务端执行对应SQL语句，将用户-分区信息从数据库删除，返回退出成功信息。
		- 获取分区列表：客户端发送获取分区列表请求，服务端执行对应SQL语句，从数据库生成分区列表DAO对象，翻译成消息串返回给客户端。
	- 浏览服务
		- 拉取贴子：客户端发送拉取贴子请求，服务端执行对应SQL语句，从数据库中分区-贴子信息生成贴子DAO对象列表，翻译成消息串返回给客户端。
        - 拉取楼层：客户端发送拉取楼层请求，服务端执行对应SQL语句，从数据库中贴子-楼层信息生成楼层DAO对象列表，翻译成消息串返回给客户端。
		- 收藏帖子：客户端发送收藏帖子请求，服务端执行对应SQL语句，将用户-收藏信息存入数据库，返回收藏成功信息。
	- 发布服务
		- 发贴：客户端发送发贴请求及内容，服务端解析消息串为贴子DAO对象，执行对应SQL语句，将分区-贴子信息存入数据库，返回发布成功信息。
		- 跟贴：客户端发送跟贴请求及内容，服务端解析消息串为楼层DAO对象，执行对应SQL语句，将贴子-楼层信息存入数据库，返回跟贴成功信息。
	- 搜索服务
		- 搜索贴子：客户端发送搜索贴子请求，服务端解析执行对应SQL语句，从数据库获取生成贴子DAO对象列表，返回给客户端。
		- 搜索分区：客户端发送搜索分区请求，服务端解析执行对应SQL语句，从数据库获取生成分区DAO对象列表，返回给客户端。
		- 搜索用户：客户端发送搜索用户请求，服务端解析执行对应SQL语句，从数据库获取生成用户DAO对象列表，返回给客户端。

- 个人模块服务
	- 用户账户服务
		- 注册：客户端发送注册请求及个人信息，服务端执行对应SQL语句检查用户名，若重复则返回注册失败，否则返回注册成功并将用户存入数据库。
		- 登录：客户端发送登录请求及账户密码，服务端执行对应SQL语句检查账户密码，若匹配则返回登录成功并将用户状态修改为在线，否则返回登录失败。
        - 登录状态维护：服务端定时检查已登录用户状态，若用户状态为在线且超过一定时间未发送心跳包，则将用户状态修改为离线。
		- 下线：客户端发送下线请求，服务端执行对应SQL语句，将用户状态修改为离线，返回下线成功信息。
		- 注销：客户端发送注销请求，服务端执行对应SQL语句，将用户状态修改为停用，返回注销成功信息。
	- 个人信息服务
		- 信息查询：客户端发送获取个人信息请求，服务端执行对应SQL语句，从数据库生成用户信息DAO对象，返回给客户端。
		- 信息修改：客户端发送修改个人信息请求及修改内容，服务端执行对应SQL语句，将用户信息存入数据库，返回修改成功信息。
	- 关注用户服务
		- 关注用户：客户端发送关注用户请求，服务端执行对应SQL语句，将用户-用户的关注信息存入数据库，返回关注成功信息。
		- 取消关注：客户端发送取消关注请求，服务端执行对应SQL语句，将用户-用户的关注信息从数据库删除，返回取消关注成功信息。
		- 获取关注列表：客户端发送获取关注列表请求，服务端执行对应SQL语句，从数据库中用户-用户信息生成关注DAO对象列表，返回给客户端。
		- 私聊服务
			- 获取消息记录：客户端发送获取消息记录请求，服务端执行对应SQL语句，从数据库中用户-用户&消息信息生成私聊记录DAO对象，返回给客户端。
			- 发送消息服务：客户端发送发送消息请求，服务端执行对应SQL语句，将用户-用户&消息信息记录存入数据库，返回发送成功信息。
            - 接受消息服务：服务端将来自客户端的消息存入数据库用户-用户&消息信息中；检查接收方状态，若接收方在线，也将消息转发给接收方客户端。
        - 收藏管理服务
            - 收藏查询：客户端发送收藏查询请求，服务端执行对应SQL语句，从数据库中用户-收藏信息生成收藏DAO对象列表，返回给客户端。
            - 收藏取消：客户端发送取消收藏请求，服务端执行对应SQL语句，将用户-收藏信息从数据库删除，返回收藏删除成功信息。
        - 发布管理服务
            - 贴子查询：客户端发送贴子查询请求，服务端执行对应SQL语句，从数据库中用户-贴子信息生成贴子DAO对象列表，返回给客户端。
            - 贴子删除：客户端发送贴子删除请求，服务端执行对应SQL语句，将用户-贴子信息信息从数据库删除，返回贴子删除成功信息。

### 桌面客户端

- 总述：
	- 通过Java Swing实现桌面客户端的UI设计；通过Java Socket实现客户端与服务端的通信。
    - 将来自服务端的消息串解析成DAO对象，再将DAO对象传递给UI界面，实现UI界面的更新。
    - 将来自UI界面的请求对应为特定的消息串，再将消息串传递给服务端，实现客户端与服务端的通信。
- 树洞模块
	- 分区
		- 自动加载：用户默认加入全国分区和对应高校分区；进入树洞界面后，默认进入全国分区树洞，加载全国分区树洞的贴子，展示在界面中。
		- 手动切换：用户点击分区按钮，切换到对应分区树洞，加载对应分区树洞的贴子，展示在界面中。
		- 加入分区：用户点击加入分区按钮，将信息发送给服务端，服务端处理数据，返回加入成功信息，将分区信息添加进用户分区列表中。
		- 退出分区：用户点击退出分区按钮，将信息发送给服务端，服务端处理数据，返回退出成功信息，将分区信息从用户分区列表中删除。
	- 浏览
		- 自动刷新：用户进入树洞界面后，自动获取该树洞最新发布的特定条数的一页贴子，展示在界面中；
            进入贴子后，则自动获取该贴子对应楼层特定条数的一页数据，按时间顺序展示在界面中。
		- 手动刷新：用户点击刷新按钮，获取树洞最新发布的特定条数贴子，展示在界面中；
            进入贴子后，点击刷新按钮，则获取该贴子最新发布的对应楼层数据，按时间顺序展示在界面中。
		- 分页浏览：用户点击上一页、下一页按钮，获取树洞上一页、下一页的特定条数信息，展示在界面中；
            进入贴子后，点击上一页、下一页按钮，则获取该贴子上一页、下一页的特定条数楼层信息，按时间顺序展示在界面中。
		- 收藏贴子：用户点击收藏按钮，将信息发送给服务端，服务端处理数据，返回收藏成功信息。
		- 分享贴子：用户点击分享按钮，获取贴子对应的Web端链接，将链接复制到剪贴板。
	- 发布
		- 发贴：用户在树洞界面中输入待发贴内容，点击发布按钮，将信息发送给服务端，显示服务端发回的发帖状态。
		- 跟贴：用户在树洞界面中输入待跟贴内容，点击评论按钮，将信息发送给服务端，显示服务端发回的跟贴状态。
	- 搜索
		- 贴子搜索：用户输入关键词，点击搜索按钮，获取树洞中包含关键词的贴子，展示在界面中。可以点击进入该贴子。
		- 分区搜索：用户输入关键词，点击搜索按钮，获取树洞中包含关键词的分区，展示在界面中。可以点击加入该分区。
		- 用户搜索：用户输入关键词，点击搜索按钮，获取树洞中包含关键词的用户，展示在界面中。可以点击进入该用户的个人中心。

- 个人中心模块
	- 用户账户（个人视图）：未登录用户可以注册、登录；已登录用户可以下线、注销
		- 注册：用户输入用户名、密码、性别、年龄、学校、专业等信息，点击注册按钮，将信息发送给服务端，显示服务端发回的注册结果。
		- 登录：用户输入用户名、密码，点击登录按钮，将信息发送给服务端，显示服务端发回的登录结果。
		- 登录状态维护：用户登录成功后，定时向服务端发送心跳包，维护用户登录状态。
		- 下线：用户点击退出按钮，将信息发送给服务端，显示服务端发回的下线状态。
		- 注销：用户点击注销按钮，将信息发送给服务端，显示服务端发回的注销状态。
	- 个人信息：已登录用户可以查看和修改自己的个人信息
		- 信息查询：用户进入个人中心界面后，发送查询用户信息给服务端，展示服务器发回的用户信息。
		- 信息修改（个人视图）：已登录用户在个人中心界面中修改信息，点击修改按钮，将信息发送给服务端，显示服务端发回的修改结果。
	- 关注用户：已登录用户可以在自己的个人中心查看关注列表，在他人的个人中心添加和取消关注。
		- 添加关注：用户点击待关注用户的关注按钮，将信息发送给服务端，显示服务端发回的关注状态。
		- 取消关注：用户点击待取关用户的取消关注按钮，将信息发送给服务端，显示服务端发回的取消关注状态。
		- 关注查询（个人视图）：用户进入关注列表界面后，发送查询关注信息给服务端，展示服务器发回的关注列表。
		- 私聊（个人视图）：相互关注的用户可以进行私聊
			- 消息记录：用户进入与某相互关注的私聊界面中，自动向服务端发送请求，获取与该用户的私聊记录，展示在界面中。
			- 发送消息：用户在私聊界面中输入待发送消息，点击发送按钮，将信息发送给服务端，显示服务端发回的发送状态。
			- 接收消息：用户在私聊界面中，自动接收服务端转发来的消息，展示在界面中。
	- 我的收藏（个人视图）：收藏管理功能，已登录用户可以查看和取消自己收藏的贴子
		- 收藏查询：用户进入个人中心界面后，发送查询收藏信息给服务端，服务端处理数据，返回收藏信息。
		- 取消收藏：用户点击取消收藏按钮，将信息发送给服务端，服务端处理数据，返回取消收藏成功信息。
	- 我的发布（个人视图）：发布管理功能，已登录用户可以查看和删除自己发布的贴子
		- 贴子查询：用户进入个人中心界面后，发送查询贴子信息给服务端，服务端处理数据，返回贴子信息。
		- 贴子删除：用户点击删除按钮，将信息发送给服务端，服务端处理数据，返回删除成功信息。

---

## Web端

[//]: # (TODO)

### Web服务端

[//]: # (TODO)

### Web客户端（浏览器）

[//]: # (TODO)